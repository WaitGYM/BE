# ğŸ‹ï¸â€â™‚ï¸ í—¬ìŠ¤ì¥ ì›¨ì´íŒ… ì‹œìŠ¤í…œ (Gym Waiting System)

> **ì‹¤ì‹œê°„ ê¸°êµ¬ ëŒ€ê¸°ì—´ ê´€ë¦¬ ì‹œìŠ¤í…œ** - ì¤„ì„œê¸° ë°©ì‹ìœ¼ë¡œ ê³µì •í•˜ê³  íš¨ìœ¨ì ì¸ í—¬ìŠ¤ì¥ ê¸°êµ¬ ì‚¬ìš©

## ğŸ“– ê°œìš”

ê¸°ì¡´ì˜ ë³µì¡í•œ **ì‹œê°„ ì˜ˆì•½ ì‹œìŠ¤í…œ**ì„ ë„˜ì–´ì„ , ì‹¤ì œ í—¬ìŠ¤ì¥ í™˜ê²½ì— ìµœì í™”ëœ **ì›¨ì´íŒ…(ëŒ€ê¸°ì—´) ì‹œìŠ¤í…œ**ì…ë‹ˆë‹¤. 
ì‹œê°„ì„ ë¯¸ë¦¬ ì •í•˜ì§€ ì•Šê³ , í˜„ì¥ì—ì„œ **"ì¤„ì„œê¸°"** ë°©ì‹ìœ¼ë¡œ ìˆœì„œë¥¼ ê¸°ë‹¤ë¦° í›„, **ì„¸íŠ¸ë³„ ìš´ë™ ì§„í–‰ì„ ì‹¤ì‹œê°„ ì¶”ì **í•˜ì—¬ ìë™ìœ¼ë¡œ ë‹¤ìŒ ì‚¬ëŒì—ê²Œ ë„˜ì–´ê°€ëŠ” ìì—°ìŠ¤ëŸ¬ìš´ í”Œë¡œìš°ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

### ğŸ¯ í•µì‹¬ ì•„ì´ë””ì–´
- **âŒ ì‹œê°„ ì˜ˆì•½**: "ì˜¤í›„ 2ì‹œë¶€í„° 3ì‹œê¹Œì§€ ë²¤ì¹˜í”„ë ˆìŠ¤ ì˜ˆì•½"
- **âœ… ì›¨ì´íŒ…**: "ë²¤ì¹˜í”„ë ˆìŠ¤ ëŒ€ê¸° â†’ ì•Œë¦¼ ë°›ê¸° â†’ 3ì„¸íŠ¸ ìš´ë™ â†’ ìë™ ì™„ë£Œ"

## âœ¨ ì£¼ìš” íŠ¹ì§•

### ğŸ”” **ì‹¤ì‹œê°„ ì•Œë¦¼ ì‹œìŠ¤í…œ**
- WebSocket ê¸°ë°˜ ì¦‰ì‹œ ì•Œë¦¼
- ë¸Œë¼ìš°ì € í‘¸ì‹œ ì•Œë¦¼ + ì§„ë™(ëª¨ë°”ì¼)
- 5ë¶„ ìœ ì˜ˆì‹œê°„ ìë™ ê´€ë¦¬

### ğŸ‹ï¸ **ì„¸íŠ¸ë³„ ìš´ë™ ì§„í–‰ ì¶”ì **
- 1~20ì„¸íŠ¸ ììœ  ì„¤ì • (ê¸°ë³¸ 3ì„¸íŠ¸)
- ì„¸íŠ¸ ì™„ë£Œ â†’ ìë™ íœ´ì‹ íƒ€ì´ë¨¸ â†’ ë‹¤ìŒ ì„¸íŠ¸ ì‹œì‘
- ë§ˆì§€ë§‰ ì„¸íŠ¸ ì™„ë£Œ ì‹œ **ìë™ìœ¼ë¡œ ë‹¤ìŒ ì‚¬ëŒì—ê²Œ**
- ì‹¤ì‹œê°„ ì§„í–‰ë¥  í‘œì‹œ ë° ë‚¨ì€ íœ´ì‹ì‹œê°„ ì¹´ìš´íŠ¸ë‹¤ìš´

### ğŸ“± **ì§ê´€ì ì¸ ì‚¬ìš© ê²½í—˜**
- **ì‹œê°„ ì…ë ¥ ë¶ˆí•„ìš”** - ëŒ€ê¸°ì—´ ë“±ë¡ë§Œ í•˜ë©´ ë
- í˜„ì¬ ìƒíƒœ í•œëˆˆì— íŒŒì•… (ìš´ë™ ì¤‘ vs íœ´ì‹ ì¤‘)
- ìœ ì—°í•œ ì œì–´ (íœ´ì‹ ê±´ë„ˆë›°ê¸°, ìš´ë™ ì¤‘ë‹¨)
- í¬ë¡œìŠ¤ í”Œë«í¼ ë°˜ì‘í˜• ì§€ì›

### ğŸ”„ **ìë™ ëŒ€ê¸°ì—´ ê´€ë¦¬**
- ê³µì •í•œ FIFO(First In, First Out) ìˆœì„œ
- ì·¨ì†Œ/ë§Œë£Œ ì‹œ ìë™ ìˆœë²ˆ ì¬ë°°ì¹˜
- ì‹¤ì‹œê°„ ëŒ€ê¸° í˜„í™© ëª¨ë‹ˆí„°ë§


## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ

### Backend
- **Node.js** + **Express.js** - REST API ì„œë²„
- **WebSocket (ws)** - ì‹¤ì‹œê°„ í†µì‹ 
- **Prisma ORM** - ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬
- **PostgreSQL** - ë°ì´í„°ë² ì´ìŠ¤
- **Passport.js** - Google OAuth ì¸ì¦
- **JWT** - í† í° ê¸°ë°˜ ì¸ì¦

## ğŸ— ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    HTTP/WS     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Prisma    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                 â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                 â”‚
â”‚   React Client  â”‚                â”‚  Express Server â”‚              â”‚   PostgreSQL    â”‚
â”‚                 â”‚                â”‚   + WebSocket   â”‚              â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–²                                    â–²
         â”‚                                    â”‚
         â–¼                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Browser Push   â”‚                â”‚   Google OAuth  â”‚
â”‚  Notifications  â”‚                â”‚   Authentication â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### í•µì‹¬ í…Œì´ë¸”

#### 1. EquipmentUsage (ê¸°êµ¬ ì‚¬ìš© í˜„í™©)
```sql
- id: ê³ ìœ  ID
- equipmentId: ê¸°êµ¬ ID (FK)
- userId: ì‚¬ìš©ì ID (FK)
- totalSets: ì „ì²´ ì„¸íŠ¸ ìˆ˜ (1~20)
- currentSet: í˜„ì¬ ì„¸íŠ¸ (1ë¶€í„° ì‹œì‘)
- restMinutes: ì„¸íŠ¸ê°„ íœ´ì‹ ì‹œê°„ (0~10ë¶„)
- status: ì „ì²´ ìƒíƒœ (IN_USE, COMPLETED)
- setStatus: ì„¸íŠ¸ ìƒíƒœ (EXERCISING, RESTING, COMPLETED, STOPPED)
- startedAt: ìš´ë™ ì‹œì‘ ì‹œê°„
- currentSetStartedAt: í˜„ì¬ ì„¸íŠ¸ ì‹œì‘ ì‹œê°„
- restStartedAt: íœ´ì‹ ì‹œì‘ ì‹œê°„
- endedAt: ìš´ë™ ì™„ë£Œ ì‹œê°„
```

#### 2. WaitingQueue (ëŒ€ê¸°ì—´)
```sql
- id: ê³ ìœ  ID
- equipmentId: ê¸°êµ¬ ID (FK)
- userId: ì‚¬ìš©ì ID (FK)
- queuePosition: ëŒ€ê¸° ìˆœë²ˆ (1, 2, 3...)
- status: ëŒ€ê¸° ìƒíƒœ (WAITING, NOTIFIED, COMPLETED, CANCELLED, EXPIRED)
- createdAt: ë“±ë¡ ì‹œê°„
- notifiedAt: ì•Œë¦¼ ì‹œê°„
```


### 3.ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
```bash
# Prisma ì´ˆê¸°í™” (ì´ë¯¸ ë˜ì–´ìˆë‹¤ë©´ ìŠ¤í‚µ)
npx prisma generate


### ì„œë²„ ì‹¤í–‰
npm run dev

### 6. ì ‘ì† í™•ì¸
ì„œë²„ ì‹œì‘ ì‹œ ë‹¤ìŒê³¼ ê°™ì€ ë©”ì‹œì§€ê°€ ì¶œë ¥ë©ë‹ˆë‹¤:
```
ğŸ‰====================================ğŸ‰
ğŸš€ API ì„œë²„: http://localhost:4000
ğŸ”Œ WebSocket: ws://localhost:4000/ws
ğŸ“± ì‹¤ì‹œê°„ ì•Œë¦¼: í™œì„±í™”
ğŸ—„ï¸  ë°ì´í„°ë² ì´ìŠ¤: ì—°ê²°ë¨
ğŸŒ í™˜ê²½: development
ğŸ‰====================================ğŸ‰
```
## ğŸ“± ì‚¬ìš© ë°©ë²•

### 1. íšŒì›ê°€ì… ë° ë¡œê·¸ì¸
- Google ê³„ì •ìœ¼ë¡œ ê°„í¸ ë¡œê·¸ì¸ (OAuth 2.0)
- ìµœì´ˆ ë¡œê·¸ì¸ ì‹œ ìë™ íšŒì›ê°€ì…

### 2. ê¸°êµ¬ ë‘˜ëŸ¬ë³´ê¸°
- ì¹´í…Œê³ ë¦¬ë³„ ê¸°êµ¬ ëª©ë¡ (ê°€ìŠ´, ë“±, ë‹¤ë¦¬, ì–´ê¹¨, íŒ”, ìœ ì‚°ì†Œ, ë³µê·¼)
- ì‹¤ì‹œê°„ ì‚¬ìš© í˜„í™© ë° ëŒ€ê¸°ì—´ ì •ë³´ í™•ì¸

### 3. ì›¨ì´íŒ… ì‹œìŠ¤í…œ ì‚¬ìš©í•˜ê¸°

#### Case 1: ê¸°êµ¬ê°€ ë¹„ì–´ìˆì„ ë•Œ
```
1. ê¸°êµ¬ ì„ íƒ
2. ìš´ë™ ì„¤ì • (ì„¸íŠ¸ ìˆ˜, íœ´ì‹ ì‹œê°„)
3. "ë°”ë¡œ ì‹œì‘" í´ë¦­
4. ì„¸íŠ¸ë³„ ìš´ë™ ì§„í–‰
5. ìë™ ì™„ë£Œ â†’ ë‹¤ìŒ ëŒ€ê¸°ìì—ê²Œ ì•Œë¦¼
```

#### Case 2: ê¸°êµ¬ê°€ ì‚¬ìš© ì¤‘ì¼ ë•Œ
```
1. ê¸°êµ¬ ì„ íƒ
2. "ëŒ€ê¸°ì—´ ë“±ë¡" í´ë¦­ â†’ ìˆœë²ˆ ë°›ê¸°
3. ëŒ€ê¸° ì¤‘ (ì‹¤ì‹œê°„ ìˆœë²ˆ í™•ì¸)
4. ì•Œë¦¼ ë°›ê¸° "ê¸°êµ¬ ì‚¬ìš© ê°€ëŠ¥!" (5ë¶„ ìœ ì˜ˆì‹œê°„)
5. "ìš´ë™ ì‹œì‘" í´ë¦­
6. ì„¸íŠ¸ë³„ ìš´ë™ ì§„í–‰
7. ìë™ ì™„ë£Œ â†’ ë‹¤ìŒ ëŒ€ê¸°ìì—ê²Œ ì•Œë¦¼
```

### 4. ì„¸íŠ¸ë³„ ìš´ë™ ì§„í–‰
- **ì„¸íŠ¸ ì‹œì‘**: ìë™ìœ¼ë¡œ í˜„ì¬ ì„¸íŠ¸ í‘œì‹œ
- **ì„¸íŠ¸ ì™„ë£Œ**: "ì„¸íŠ¸ ì™„ë£Œ" ë²„íŠ¼ â†’ ìë™ íœ´ì‹ ì‹œì‘
- **íœ´ì‹ ì¤‘**: ì¹´ìš´íŠ¸ë‹¤ìš´ íƒ€ì´ë¨¸ â†’ ìë™ìœ¼ë¡œ ë‹¤ìŒ ì„¸íŠ¸
- **íœ´ì‹ ê±´ë„ˆë›°ê¸°**: "ë‹¤ìŒ ì„¸íŠ¸ ì‹œì‘" ë²„íŠ¼ìœ¼ë¡œ ì¦‰ì‹œ ë‹¤ìŒ ì„¸íŠ¸
- **ìš´ë™ ì¤‘ë‹¨**: "ì¤‘ë‹¨" ë²„íŠ¼ìœ¼ë¡œ ì–¸ì œë“  ì¢…ë£Œ ê°€ëŠ¥

## ğŸ”„ ìš´ë™ í”Œë¡œìš° ìƒì„¸

### ğŸ¯ **ì„¸íŠ¸ë³„ ì§„í–‰ ì˜ˆì‹œ** (3ì„¸íŠ¸, 3ë¶„ íœ´ì‹)

```mermaid
graph TD
    A[ìš´ë™ ì‹œì‘] --> B[ì„¸íŠ¸ 1 ìš´ë™ ì¤‘]
    B --> C[ì„¸íŠ¸ ì™„ë£Œ ë²„íŠ¼]
    C --> D[3ë¶„ íœ´ì‹ íƒ€ì´ë¨¸]
    D --> E[ìë™ìœ¼ë¡œ ì„¸íŠ¸ 2 ì‹œì‘]
    E --> F[ì„¸íŠ¸ ì™„ë£Œ ë²„íŠ¼]
    F --> G[3ë¶„ íœ´ì‹ íƒ€ì´ë¨¸]
    G --> H[ìë™ìœ¼ë¡œ ì„¸íŠ¸ 3 ì‹œì‘]
    H --> I[ì„¸íŠ¸ ì™„ë£Œ ë²„íŠ¼]
    I --> J[ğŸ‰ ì „ì²´ ìš´ë™ ì™„ë£Œ]
    J --> K[ë‹¤ìŒ ëŒ€ê¸°ìì—ê²Œ ìë™ ì•Œë¦¼]
    
    D --> L[íœ´ì‹ ê±´ë„ˆë›°ê¸°]
    L --> E
    G --> M[íœ´ì‹ ê±´ë„ˆë›°ê¸°]
    M --> H
    
    B --> N[ìš´ë™ ì¤‘ë‹¨]
    E --> N
    H --> N
    N --> K
```


## ğŸ‹ï¸ í—¬ìŠ¤ì¥ ê¸°êµ¬ ì˜ˆì•½ ë° ì›¨ì´íŒ… ì‹œìŠ¤í…œ - Backend API ë¬¸ì„œ
1. [ì‹œìŠ¤í…œ ê°œìš”](#ì‹œìŠ¤í…œ-ê°œìš”)
2. [ì¸ì¦ ì‹œìŠ¤í…œ](#ì¸ì¦-ì‹œìŠ¤í…œ)
3. [ê¸°êµ¬ ê´€ë¦¬ API](#ê¸°êµ¬-ê´€ë¦¬-api)
4. [ì˜ˆì•½ ì‹œìŠ¤í…œ API](#ì˜ˆì•½-ì‹œìŠ¤í…œ-api)
5. [ì¦ê²¨ì°¾ê¸° API](#ì¦ê²¨ì°¾ê¸°-api)
6. [ì›¨ì´íŒ… ì‹œìŠ¤í…œ API](#ì›¨ì´íŒ…-ì‹œìŠ¤í…œ-api)
7. [ì‹¤ì‹œê°„ ì•Œë¦¼ (WebSocket)](#ì‹¤ì‹œê°„-ì•Œë¦¼-websocket)
8. [ë°ì´í„° ëª¨ë¸](#ë°ì´í„°-ëª¨ë¸)
9. [í™˜ê²½ ì„¤ì •](#í™˜ê²½-ì„¤ì •)

## ğŸ¯ ì‹œìŠ¤í…œ ê°œìš”

ì´ ì‹œìŠ¤í…œì€ í—¬ìŠ¤ì¥ì˜ ê¸°êµ¬ ì‚¬ìš©ì„ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê¸° ìœ„í•œ ë°±ì—”ë“œ APIì…ë‹ˆë‹¤. ì£¼ìš” ê¸°ëŠ¥ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

- **Google OAuth ì¸ì¦**: ê°„í¸í•œ ì†Œì…œ ë¡œê·¸ì¸
- **ê¸°êµ¬ ê´€ë¦¬**: ì¹´í…Œê³ ë¦¬ë³„ í—¬ìŠ¤ì¥ ê¸°êµ¬ ì¡°íšŒ
- **ì˜ˆì•½ ì‹œìŠ¤í…œ**: ì‹œê°„ ê¸°ë°˜ ê¸°êµ¬ ì˜ˆì•½
- **ì›¨ì´íŒ… ì‹œìŠ¤í…œ**: ì‹¤ì‹œê°„ ëŒ€ê¸°ì—´ ê´€ë¦¬ ë° ì„¸íŠ¸ë³„ ìš´ë™ ì¶”ì 
- **ì¦ê²¨ì°¾ê¸°**: ìì£¼ ì‚¬ìš©í•˜ëŠ” ê¸°êµ¬ ì €ì¥
- **ì‹¤ì‹œê°„ ì•Œë¦¼**: WebSocketì„ í†µí•œ ì¦‰ì‹œ ì•Œë¦¼

## ğŸ” ì¸ì¦ ì‹œìŠ¤í…œ

### 1. Google OAuth ë¡œê·¸ì¸

#### ë¡œê·¸ì¸ ì‹œì‘
```http
GET /api/auth/google
```
- ì‚¬ìš©ìë¥¼ Google OAuth í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

#### ë¡œê·¸ì¸ ì½œë°± (ìë™ ì²˜ë¦¬ë¨)
```http
GET /api/auth/google/callback
```
- Googleì—ì„œ ì½œë°± í›„ í”„ë¡ íŠ¸ì—”ë“œë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
- ì„±ê³µ: `${FRONTEND_URL}/oauth-success?token=JWT_TOKEN&user=USER_INFO`
- ì‹¤íŒ¨: `${FRONTEND_URL}/?error=auth_failed`

#### í˜„ì¬ ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ
```http
GET /api/auth/me
Authorization: Bearer {JWT_TOKEN}
```

**ì‘ë‹µ ì˜ˆì‹œ:**
```json
{
  "id": 1,
  "email": "user@example.com",
  "name": "í™ê¸¸ë™",
  "avatar": "https://lh3.googleusercontent.com/...",
  "createdAt": "2025-01-01T00:00:00.000Z"
}
```

#### ë¡œê·¸ì•„ì›ƒ
```http
POST /api/auth/logout
```

## ğŸ‹ï¸ ê¸°êµ¬ ê´€ë¦¬ API

### 1. ê¸°êµ¬ ëª©ë¡ ì¡°íšŒ
```http
GET /api/equipment?category=ê°€ìŠ´&search=ë²¤ì¹˜
Authorization: Bearer {JWT_TOKEN} (ì„ íƒì‚¬í•­)
```

**ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°:**
- `category` (ì„ íƒ): ì¹´í…Œê³ ë¦¬ í•„í„° (`ê°€ìŠ´`, `ë“±`, `ë‹¤ë¦¬`, `ì–´ê¹¨`, `íŒ”`, `ìœ ì‚°ì†Œ`)
- `search` (ì„ íƒ): ê¸°êµ¬ëª…/ê·¼ìœ¡ê·¸ë£¹ ê²€ìƒ‰

**ì‘ë‹µ ì˜ˆì‹œ:**
```json
[
  {
    "id": 8,
    "name": "ë°”ë²¨ ë²¤ì¹˜ í”„ë ˆìŠ¤",
    "imageUrl": null,
    "category": "ê°€ìŠ´",
    "muscleGroup": "ëŒ€í‰ê·¼, ì‚¼ë‘, ì–´ê¹¨",
    "createdAt": "2025-01-01T00:00:00.000Z",
    "reservationCount": 5,
    "isFavorite": true
  }
]
```

### 2. ì¹´í…Œê³ ë¦¬ ëª©ë¡ ì¡°íšŒ
```http
GET /api/equipment/categories
```

**ì‘ë‹µ ì˜ˆì‹œ:**
```json
[
  { "name": "ê°€ìŠ´", "count": 3 },
  { "name": "ë“±", "count": 4 },
  { "name": "ë‹¤ë¦¬", "count": 5 }
]
```

### 3. íŠ¹ì • ê¸°êµ¬ ìƒì„¸ ì¡°íšŒ
```http
GET /api/equipment/{equipmentId}
Authorization: Bearer {JWT_TOKEN} (ì„ íƒì‚¬í•­)
```

**ì‘ë‹µ ì˜ˆì‹œ:**
```json
{
  "id": 8,
  "name": "ë°”ë²¨ ë²¤ì¹˜ í”„ë ˆìŠ¤",
  "imageUrl": null,
  "category": "ê°€ìŠ´",
  "muscleGroup": "ëŒ€í‰ê·¼, ì‚¼ë‘, ì–´ê¹¨",
  "createdAt": "2025-01-01T00:00:00.000Z",
  "reservations": [
    {
      "id": 1,
      "startAt": "2025-01-01T10:00:00.000Z",
      "endAt": "2025-01-01T10:30:00.000Z",
      "user": { "name": "í™ê¸¸ë™" }
    }
  ],
  "isFavorite": false,
  "favoriteCount": 12
}
```

## ğŸ“… ì˜ˆì•½ ì‹œìŠ¤í…œ API

### 1. ì˜ˆì•½ ìƒì„±
```http
POST /api/reservations
Authorization: Bearer {JWT_TOKEN}
Content-Type: application/json
```

**ìš”ì²­ ë°”ë””:**
```json
{
  "equipmentId": 1,
  "startAt": "2025-01-01T10:00:00.000Z",
  "endAt": "2025-01-01T10:30:00.000Z",
  "sets": 3,
  "restMinutes": 2
}
```

**ì‘ë‹µ ì˜ˆì‹œ:**
```json
{
  "id": 1,
  "equipmentId": 1,
  "userId": 1,
  "startAt": "2025-01-01T10:00:00.000Z",
  "endAt": "2025-01-01T10:30:00.000Z",
  "sets": 3,
  "restMinutes": 2,
  "status": "BOOKED",
  "equipment": {
    "id": 1,
    "name": "ë°”ë²¨ ë²¤ì¹˜ í”„ë ˆìŠ¤"
  }
}
```

### 2. ë‚´ ì˜ˆì•½ ëª©ë¡ ì¡°íšŒ
```http
GET /api/reservations/me
Authorization: Bearer {JWT_TOKEN}
```

### 3. ì˜ˆì•½ ê°€ëŠ¥ ì‹œê°„ í™•ì¸
```http
GET /api/reservations/availability?equipmentId=1&date=2025-01-01&open=09:00&close=18:00&slotMinutes=30
```

**ì‘ë‹µ ì˜ˆì‹œ:**
```json
{
  "equipmentId": 1,
  "date": "2025-01-01",
  "slotMinutes": 30,
  "slots": [
    {
      "startAt": "2025-01-01T09:00:00.000Z",
      "endAt": "2025-01-01T09:30:00.000Z"
    }
  ],
  "existingReservations": [
    {
      "id": 1,
      "startAt": "2025-01-01T10:00:00.000Z",
      "endAt": "2025-01-01T10:30:00.000Z",
      "userName": "í™ê¸¸ë™"
    }
  ]
}
```

### 4. ì˜ˆì•½ ìˆ˜ì •/ì‚­ì œ
```http
PUT /api/reservations/{reservationId}
DELETE /api/reservations/{reservationId}
Authorization: Bearer {JWT_TOKEN}
```

## â­ ì¦ê²¨ì°¾ê¸° API

### 1. ë‚´ ì¦ê²¨ì°¾ê¸° ëª©ë¡
```http
GET /api/favorites
Authorization: Bearer {JWT_TOKEN}
```

### 2. ì¦ê²¨ì°¾ê¸° ì¶”ê°€
```http
POST /api/favorites
Authorization: Bearer {JWT_TOKEN}
Content-Type: application/json
```

**ìš”ì²­ ë°”ë””:**
```json
{
  "equipmentId": 1
}
```

### 3. ì¦ê²¨ì°¾ê¸° ì œê±°
```http
DELETE /api/favorites/equipment/{equipmentId}
Authorization: Bearer {JWT_TOKEN}
```

### 4. ì¦ê²¨ì°¾ê¸° ìƒíƒœ í™•ì¸
```http
GET /api/favorites/check/{equipmentId}
Authorization: Bearer {JWT_TOKEN}
```

**ì‘ë‹µ ì˜ˆì‹œ:**
```json
{
  "isFavorite": true
}
```

## ğŸš¶â€â™‚ï¸ ì›¨ì´íŒ… ì‹œìŠ¤í…œ API

ì›¨ì´íŒ… ì‹œìŠ¤í…œì€ ì‹¤ì‹œê°„ìœ¼ë¡œ ê¸°êµ¬ ì‚¬ìš© í˜„í™©ì„ ì¶”ì í•˜ê³  ëŒ€ê¸°ì—´ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.

### ğŸƒâ€â™‚ï¸ ìš´ë™ ê´€ë¦¬ API

#### 1. ê¸°êµ¬ ì‚¬ìš© ì‹œì‘
```http
POST /api/waiting/start-using/{equipmentId}
Authorization: Bearer {JWT_TOKEN}
Content-Type: application/json
```

**ìš”ì²­ ë°”ë””:**
```json
{
  "totalSets": 3,
  "restMinutes": 2
}
```

**ì‘ë‹µ ì˜ˆì‹œ:**
```json
{
  "id": 1,
  "equipmentId": 1,
  "equipmentName": "ë°”ë²¨ ë²¤ì¹˜ í”„ë ˆìŠ¤",
  "totalSets": 3,
  "currentSet": 1,
  "setStatus": "EXERCISING",
  "restMinutes": 2,
  "startedAt": "2025-01-01T10:00:00.000Z",
  "currentSetStartedAt": "2025-01-01T10:00:00.000Z",
  "estimatedEndAt": "2025-01-01T10:15:00.000Z",
  "progress": 33
}
```

#### 2. ì„¸íŠ¸ ì™„ë£Œ
```http
POST /api/waiting/complete-set/{equipmentId}
Authorization: Bearer {JWT_TOKEN}
```

**ì‘ë‹µ ì˜ˆì‹œ:**
```json
{
  "message": "1/3 ì„¸íŠ¸ ì™„ë£Œ",
  "setStatus": "RESTING"
}
```

#### 3. íœ´ì‹ ìŠ¤í‚µ (ë‹¤ìŒ ì„¸íŠ¸ ë°”ë¡œ ì‹œì‘)
```http
POST /api/waiting/skip-rest/{equipmentId}
Authorization: Bearer {JWT_TOKEN}
```

#### 4. ìš´ë™ ì¤‘ë‹¨
```http
POST /api/waiting/stop-exercise/{equipmentId}
Authorization: Bearer {JWT_TOKEN}
```

#### 5. ìš´ë™ ìƒíƒœ ì¡°íšŒ
```http
GET /api/waiting/exercise-status/{equipmentId}
Authorization: Bearer {JWT_TOKEN}
```

**ì‘ë‹µ ì˜ˆì‹œ:**
```json
{
  "equipmentId": 1,
  "equipmentName": "ë°”ë²¨ ë²¤ì¹˜ í”„ë ˆìŠ¤",
  "totalSets": 3,
  "currentSet": 2,
  "setStatus": "RESTING",
  "restMinutes": 2,
  "restTimeLeftSec": 45,
  "currentSetElapsedSec": 180,
  "etaMinutes": 8,
  "progress": 67
}
```

### ğŸ“ ëŒ€ê¸°ì—´ ê´€ë¦¬ API

#### 1. ëŒ€ê¸°ì—´ ë“±ë¡
```http
POST /api/waiting/queue/{equipmentId}
Authorization: Bearer {JWT_TOKEN}
```

**ì‘ë‹µ ì˜ˆì‹œ:**
```json
{
  "id": 1,
  "queuePosition": 2,
  "equipmentId": 1,
  "equipmentName": "ë°”ë²¨ ë²¤ì¹˜ í”„ë ˆìŠ¤",
  "status": "WAITING"
}
```

#### 2. ëŒ€ê¸° ì·¨ì†Œ
```http
DELETE /api/waiting/queue/{queueId}
Authorization: Bearer {JWT_TOKEN}
```

#### 3. ê¸°êµ¬ ìƒíƒœ ì¡°íšŒ (í˜„ì¬ ì‚¬ìš©ì + ëŒ€ê¸°ì—´)
```http
GET /api/waiting/status/{equipmentId}
```

**ì‘ë‹µ ì˜ˆì‹œ:**
```json
{
  "equipmentId": 1,
  "equipmentName": "ë°”ë²¨ ë²¤ì¹˜ í”„ë ˆìŠ¤",
  "isAvailable": false,
  "currentUser": {
    "name": "í™ê¸¸ë™",
    "startedAt": "2025-01-01T10:00:00.000Z",
    "totalSets": 3,
    "currentSet": 2,
    "setStatus": "EXERCISING",
    "restMinutes": 2,
    "progress": 67,
    "estimatedEndAt": "2025-01-01T10:15:00.000Z",
    "estimatedWaitMinutes": 5
  },
  "waitingQueue": [
    {
      "id": 1,
      "position": 1,
      "userName": "ê¹€ì² ìˆ˜",
      "status": "WAITING",
      "createdAt": "2025-01-01T10:05:00.000Z",
      "estimatedWaitMinutes": 10
    }
  ],
  "totalWaiting": 1,
  "averageWaitTime": 10
}
```

### ğŸ”§ ê´€ë¦¬ì ê¸°ëŠ¥

#### 1. ëŒ€ê¸°ì—´ ì¬ì •ë ¬
```http
POST /api/waiting/reorder/{equipmentId}
Authorization: Bearer {JWT_TOKEN}
```

#### 2. ê°•ì œ ì™„ë£Œ (ê´€ë¦¬ì)
```http
POST /api/waiting/force-complete/{equipmentId}
Authorization: Bearer {JWT_TOKEN}
```

#### 3. í†µê³„ ì¡°íšŒ
```http
GET /api/waiting/stats
Authorization: Bearer {JWT_TOKEN}
```

**ì‘ë‹µ ì˜ˆì‹œ:**
```json
{
  "today": {
    "totalSessions": 45,
    "averageSets": 3
  },
  "week": {
    "totalSessions": 312
  },
  "current": {
    "activeUsers": 5,
    "waitingUsers": 8,
    "totalUsers": 13
  },
  "popularEquipment": [
    {
      "equipmentId": 1,
      "equipmentName": "ë°”ë²¨ ë²¤ì¹˜ í”„ë ˆìŠ¤",
      "usageCount": 23
    }
  ]
}
```

## ğŸ”” ì‹¤ì‹œê°„ ì•Œë¦¼ (WebSocket)

### ì—°ê²° ì„¤ì •
```javascript
const ws = new WebSocket('wss://your-backend.com/ws');

ws.onopen = () => {
  // JWT í† í°ìœ¼ë¡œ ì¸ì¦
  ws.send(JSON.stringify({
    type: 'auth',
    token: 'your-jwt-token'
  }));
};

ws.onmessage = (event) => {
  const data = JSON.parse(event.data);
  console.log('ë°›ì€ ì•Œë¦¼:', data);
};
```

### ì•Œë¦¼ íƒ€ì…ë“¤

#### 1. ì¸ì¦ ì„±ê³µ
```json
{
  "type": "auth_success",
  "message": "ì‹¤ì‹œê°„ ì•Œë¦¼ ì—°ê²° ì™„ë£Œ"
}
```

#### 2. ê¸°êµ¬ ì‚¬ìš© ê°€ëŠ¥ ì•Œë¦¼
```json
{
  "type": "EQUIPMENT_AVAILABLE",
  "title": "ê¸°êµ¬ ì‚¬ìš© ê°€ëŠ¥",
  "message": "ë°”ë²¨ ë²¤ì¹˜ í”„ë ˆìŠ¤ì„ ì‚¬ìš©í•  ì°¨ë¡€ì…ë‹ˆë‹¤. 5ë¶„ ë‚´ ì‹œì‘í•´ì£¼ì„¸ìš”",
  "equipmentId": 1,
  "equipmentName": "ë°”ë²¨ ë²¤ì¹˜ í”„ë ˆìŠ¤",
  "queueId": 1,
  "graceMinutes": 5
}
```

#### 3. íœ´ì‹ ì‹œì‘ ì•Œë¦¼
```json
{
  "type": "REST_STARTED",
  "title": "íœ´ì‹ ì‹œì‘",
  "message": "1/3 ì„¸íŠ¸ ì™„ë£Œ. 2ë¶„ íœ´ì‹",
  "equipmentId": 1
}
```

#### 4. ë‹¤ìŒ ì„¸íŠ¸ ì‹œì‘ ì•Œë¦¼
```json
{
  "type": "NEXT_SET_STARTED",
  "title": "ë‹¤ìŒ ì„¸íŠ¸",
  "message": "2/3 ì„¸íŠ¸ ì‹œì‘",
  "equipmentId": 1
}
```

#### 5. ëŒ€ê¸° ë§Œë£Œ ì•Œë¦¼
```json
{
  "type": "QUEUE_EXPIRED",
  "title": "ëŒ€ê¸° ë§Œë£Œ",
  "message": "ì‹œê°„ ì´ˆê³¼ë¡œ ëŒ€ê¸°ì—ì„œ ì œì™¸ë˜ì—ˆìŠµë‹ˆë‹¤",
  "equipmentId": 1
}
```

## ğŸ“Š ë°ì´í„° ëª¨ë¸

### User (ì‚¬ìš©ì)
```typescript
interface User {
  id: number;
  email: string;
  name: string;
  googleId: string;
  avatar?: string;
  createdAt: Date;
}
```

### Equipment (ê¸°êµ¬)
```typescript
interface Equipment {
  id: number;
  name: string;
  imageUrl?: string;
  category: string;  // 'ê°€ìŠ´', 'ë“±', 'ë‹¤ë¦¬', 'ì–´ê¹¨', 'íŒ”', 'ìœ ì‚°ì†Œ'
  muscleGroup?: string;
  createdAt: Date;
}
```

### EquipmentUsage (í˜„ì¬ ì‚¬ìš© ìƒíƒœ)
```typescript
interface EquipmentUsage {
  id: number;
  equipmentId: number;
  userId: number;
  startedAt: Date;
  endedAt?: Date;
  estimatedEndAt?: Date;
  totalSets: number;
  restMinutes: number;
  status: 'IN_USE' | 'COMPLETED';
  currentSet: number;
  setStatus: 'EXERCISING' | 'RESTING' | 'COMPLETED' | 'STOPPED' | 'FORCE_COMPLETED';
  currentSetStartedAt?: Date;
  restStartedAt?: Date;
  createdAt: Date;
}
```

### WaitingQueue (ëŒ€ê¸°ì—´)
```typescript
interface WaitingQueue {
  id: number;
  equipmentId: number;
  userId: number;
  queuePosition: number;
  status: 'WAITING' | 'NOTIFIED' | 'COMPLETED' | 'CANCELLED' | 'EXPIRED';
  createdAt: Date;
  notifiedAt?: Date;
  updatedAt: Date;
}
```

### Reservation (ì˜ˆì•½)
```typescript
interface Reservation {
  id: number;
  userId: number;
  equipmentId: number;
  startAt: Date;
  endAt: Date;
  sets: number;
  restMinutes: number;
  status: string;
}
```

## âš™ï¸ í™˜ê²½ ì„¤ì •

### í•„ìˆ˜ í™˜ê²½ ë³€ìˆ˜
```env
# ë°ì´í„°ë² ì´ìŠ¤
DATABASE_URL="postgresql://..."
DIRECT_URL="postgresql://..."

# JWT
JWT_SECRET="your-jwt-secret"

# ì„¸ì…˜
SESSION_SECRET="your-session-secret"

# Google OAuth
GOOGLE_CLIENT_ID="your-google-client-id"
GOOGLE_CLIENT_SECRET="your-google-client-secret"
GOOGLE_REDIRECT_URI="https://your-backend.com/api/auth/google/callback"

# í”„ë¡ íŠ¸ì—”ë“œ URL
FRONTEND_URL="https://your-frontend.com"

# CORS ì„¤ì •
CORS_ORIGINS="https://your-frontend.com,http://localhost:3000"
CORS_ORIGINS_REGEX="^https:\\/\\/.*\\.vercel\\.app$"
CORS_DEBUG="0"

# ì„œë²„
PORT="4000"
NODE_ENV="production"
```

## ğŸš¨ ì—ëŸ¬ ì²˜ë¦¬

ëª¨ë“  APIëŠ” ë‹¤ìŒ í˜•ì‹ì˜ ì—ëŸ¬ ì‘ë‹µì„ ë°˜í™˜í•©ë‹ˆë‹¤:

```json
{
  "error": "ì—ëŸ¬ ë©”ì‹œì§€",
  "details": "ìƒì„¸ ì •ë³´ (ì„ íƒì‚¬í•­)"
}
```

### ì£¼ìš” HTTP ìƒíƒœ ì½”ë“œ
- `200`: ì„±ê³µ
- `201`: ìƒì„± ì„±ê³µ
- `204`: ì‚­ì œ ì„±ê³µ (ì‘ë‹µ ë°”ë”” ì—†ìŒ)
- `400`: ì˜ëª»ëœ ìš”ì²­ (ì…ë ¥ í˜•ì‹ ì˜¤ë¥˜)
- `401`: ì¸ì¦ í•„ìš”
- `403`: ê¶Œí•œ ì—†ìŒ
- `404`: ë¦¬ì†ŒìŠ¤ ì—†ìŒ
- `409`: ì¶©ëŒ (ì¤‘ë³µ ì˜ˆì•½, ì´ë¯¸ ì‚¬ìš© ì¤‘ ë“±)
- `500`: ì„œë²„ ì˜¤ë¥˜

## ğŸ’¡ ì‚¬ìš© íŒ

1. **í† í° ê´€ë¦¬**: JWT í† í°ì€ localStorageì— ì €ì¥í•˜ê³ , ëª¨ë“  ì¸ì¦ì´ í•„ìš”í•œ API í˜¸ì¶œ ì‹œ `Authorization: Bearer {token}` í—¤ë”ì— í¬í•¨

2. **ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸**: ì›¨ì´íŒ… ì‹œìŠ¤í…œ ê´€ë ¨ í™”ë©´ì—ì„œëŠ” WebSocket ì—°ê²°ì„ ìœ ì§€í•˜ì—¬ ì‹¤ì‹œê°„ ì•Œë¦¼ ìˆ˜ì‹ 

3. **ì—ëŸ¬ ì²˜ë¦¬**: 409 ì—ëŸ¬ì˜ ê²½ìš° ì‚¬ìš©ìì—ê²Œ ëª…í™•í•œ ì•ˆë‚´ ë©”ì‹œì§€ í‘œì‹œ (ì´ë¯¸ ì‚¬ìš© ì¤‘, ëŒ€ê¸° ì¤‘ ë“±)

4. **ìƒíƒœ í´ë§**: WebSocketì´ ì—°ê²°ë˜ì§€ ì•Šì€ ìƒí™©ì—ì„œëŠ” `/api/waiting/status/{equipmentId}` ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ í˜¸ì¶œ

5. **ê¸°êµ¬ ìƒíƒœ í‘œì‹œ**: ê° ê¸°êµ¬ì˜ í˜„ì¬ ìƒíƒœ(ì‚¬ìš© ê°€ëŠ¥, ì‚¬ìš© ì¤‘, ëŒ€ê¸° ì¸ì›)ë¥¼ ëª…í™•íˆ í‘œì‹œ

ì´ API ë¬¸ì„œë¥¼ ì°¸ì¡°í•˜ì—¬ í—¬ìŠ¤ì¥ ê¸°êµ¬ ê´€ë¦¬ ì‹œìŠ¤í…œì˜ í”„ë¡ íŠ¸ì—”ë“œë¥¼ êµ¬í˜„í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¶”ê°€ ì§ˆë¬¸ì´ ìˆìœ¼ì‹œë©´ ì–¸ì œë“  ë¬¸ì˜í•´ì£¼ì„¸ìš”!

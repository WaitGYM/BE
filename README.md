# ğŸ‹ï¸â€â™‚ï¸ í—¬ìŠ¤ì¥ ì›¨ì´íŒ… ì‹œìŠ¤í…œ (Gym Waiting System)

> **ì‹¤ì‹œê°„ ê¸°êµ¬ ëŒ€ê¸°ì—´ ê´€ë¦¬ ì‹œìŠ¤í…œ** - ì¤„ì„œê¸° ë°©ì‹ìœ¼ë¡œ ê³µì •í•˜ê³  íš¨ìœ¨ì ì¸ í—¬ìŠ¤ì¥ ê¸°êµ¬ ì‚¬ìš©

## ğŸ“– ê°œìš”

ê¸°ì¡´ì˜ ë³µì¡í•œ ì‹œê°„ ì˜ˆì•½ ì‹œìŠ¤í…œì„ ë²—ì–´ë‚˜, **ì‹¤ì œ í—¬ìŠ¤ì¥ í™˜ê²½ì— ìµœì í™”ëœ ëŒ€ê¸°ì—´ ì‹œìŠ¤í…œ**ì…ë‹ˆë‹¤. 
ê¸°êµ¬ê°€ ì‚¬ìš© ì¤‘ì¼ ë•Œ ëŒ€ê¸° ìˆœë²ˆì„ ë¯¸ë¦¬ í™•ë³´í•˜ê³ , ê¸°êµ¬ê°€ ë¹„ë©´ ì‹¤ì‹œê°„ ì•Œë¦¼ì„ ë°›ì•„ 5ë¶„ ë‚´ì— ì‚¬ìš©ì„ ì‹œì‘í•˜ëŠ” ìì—°ìŠ¤ëŸ¬ìš´ í”Œë¡œìš°ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

### âœ¨ ì£¼ìš” íŠ¹ì§•

- ğŸ”” **ì‹¤ì‹œê°„ ì•Œë¦¼ ì‹œìŠ¤í…œ** - WebSocket ê¸°ë°˜ ì¦‰ì‹œ ì•Œë¦¼
- â° **5ë¶„ ìœ ì˜ˆì‹œê°„** - ê³µì •í•œ ê¸°íšŒ ì œê³µ ë° ìë™ ìˆœë²ˆ ì´ë™
- ğŸ“± **ì§ê´€ì ì¸ UI** - í˜„ì¬ ìƒíƒœ í•œëˆˆì— íŒŒì•…
- ğŸ”„ **ìë™ ëŒ€ê¸°ì—´ ê´€ë¦¬** - ì·¨ì†Œ/ë§Œë£Œ ì‹œ ìë™ ìˆœë²ˆ ì¬ë°°ì¹˜
- ğŸŒ **í¬ë¡œìŠ¤ í”Œë«í¼** - ì›¹/ëª¨ë°”ì¼ ë°˜ì‘í˜• ì§€ì›
- ğŸ“Š **ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§** - ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ

### Backend
- **Node.js** + **Express.js** - REST API ì„œë²„
- **WebSocket (ws)** - ì‹¤ì‹œê°„ í†µì‹ 
- **Prisma ORM** - ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬
- **PostgreSQL** - ë°ì´í„°ë² ì´ìŠ¤
- **Passport.js** - Google OAuth ì¸ì¦
- **JWT** - í† í° ê¸°ë°˜ ì¸ì¦


## ğŸ— ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚   React Client  â”‚â—„â”€â”€â–ºâ”‚  Express Server â”‚â—„â”€â”€â–ºâ”‚   PostgreSQL    â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–²                        â–²
         â”‚                        â”‚
         â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   WebSocket     â”‚    â”‚   Google OAuth  â”‚
â”‚   (ì‹¤ì‹œê°„ ì•Œë¦¼)   â”‚    â”‚   (ì¸ì¦)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### í•µì‹¬ í…Œì´ë¸”

#### 1. EquipmentUsage (ê¸°êµ¬ ì‚¬ìš© í˜„í™©)
```sql
- id: ê³ ìœ  ID
- equipmentId: ê¸°êµ¬ ID (FK)
- userId: ì‚¬ìš©ì ID (FK)  
- startedAt: ì‚¬ìš© ì‹œì‘ ì‹œê°„
- endedAt: ì‚¬ìš© ì¢…ë£Œ ì‹œê°„
- sets: ì„¸íŠ¸ ìˆ˜
- restMinutes: íœ´ì‹ ì‹œê°„
- status: ìƒíƒœ (IN_USE, COMPLETED)
```

#### 2. WaitingQueue (ëŒ€ê¸°ì—´)```sql  
- id: ê³ ìœ  ID
- equipmentId: ê¸°êµ¬ ID (FK)
- userId: ì‚¬ìš©ì ID (FK)
- queuePosition: ëŒ€ê¸° ìˆœë²ˆ
- status: ìƒíƒœ (WAITING, NOTIFIED, COMPLETED, CANCELLED, EXPIRED)
- createdAt: ë“±ë¡ ì‹œê°„
- notifiedAt: ì•Œë¦¼ ì‹œê°„
```

## ğŸš€ ì„¤ì¹˜ ë° ì‹¤í–‰

### 1. ì €ì¥ì†Œ í´ë¡ 
```bash
git clone https://github.com/your-username/gym-waiting-system.git
cd gym-waiting-system
```

### 2. ì˜ì¡´ì„± ì„¤ì¹˜
```bash
# ë°±ì—”ë“œ ì˜ì¡´ì„±
npm install

# WebSocket ì¶”ê°€ ì„¤ì¹˜
npm install ws



### 3.ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
```bash
# Prisma ì´ˆê¸°í™” (ì´ë¯¸ ë˜ì–´ìˆë‹¤ë©´ ìŠ¤í‚µ)
npx prisma generate


### 5. ì„œë²„ ì‹¤í–‰
npm run dev



### 6. ì ‘ì† í™•ì¸
- **API ì„œë²„**: http://localhost:4000
- **WebSocket**: ws://localhost:4000/ws  

## ğŸ“± ì‚¬ìš© ë°©ë²•

### 1. íšŒì›ê°€ì… ë° ë¡œê·¸ì¸
- Google ê³„ì •ìœ¼ë¡œ ê°„í¸ ë¡œê·¸ì¸
- ìµœì´ˆ ë¡œê·¸ì¸ ì‹œ ìë™ íšŒì›ê°€ì…

### 2. ê¸°êµ¬ ë‘˜ëŸ¬ë³´ê¸°
- ì¹´í…Œê³ ë¦¬ë³„ ê¸°êµ¬ ëª©ë¡ í™•ì¸
- ì‹¤ì‹œê°„ ì‚¬ìš© í˜„í™© í™•ì¸
- ëŒ€ê¸°ì—´ ì •ë³´ í™•ì¸

### 3. ê¸°êµ¬ ì‚¬ìš© ì‹œì‘
**Case 1: ê¸°êµ¬ê°€ ë¹„ì–´ìˆì„ ë•Œ**
```
ê¸°êµ¬ ì„ íƒ â†’ "ë°”ë¡œ ì‹œì‘" ë²„íŠ¼ â†’ ì‚¬ìš© ì¤‘ ìƒíƒœ
```

**Case 2: ê¸°êµ¬ê°€ ì‚¬ìš© ì¤‘ì¼ ë•Œ**  
```
ê¸°êµ¬ ì„ íƒ â†’ "ëŒ€ê¸°ì—´ ë“±ë¡" â†’ ìˆœë²ˆ ëŒ€ê¸° â†’ ì•Œë¦¼ ë°›ê¸° â†’ "ì‹œì‘" ë²„íŠ¼ (5ë¶„ ë‚´)
```

### 4. ê¸°êµ¬ ì‚¬ìš© ì™„ë£Œ
```
"ì‚¬ìš© ì™„ë£Œ" ë²„íŠ¼ â†’ ë‹¤ìŒ ëŒ€ê¸°ìì—ê²Œ ìë™ ì•Œë¦¼
```

## ğŸ”„ í•µì‹¬ í”Œë¡œìš°

### ì›¨ì´íŒ… ì‹œìŠ¤í…œ ë™ì‘ ê³¼ì •

```mermaid
graph TD
    A[ê¸°êµ¬ ì„ íƒ] --> B{ê¸°êµ¬ ìƒíƒœ í™•ì¸}
    B -->|ì‚¬ìš© ê°€ëŠ¥| C[ë°”ë¡œ ì‹œì‘]
    B -->|ì‚¬ìš© ì¤‘| D[ëŒ€ê¸°ì—´ ë“±ë¡]
    
    D --> E[ëŒ€ê¸° ìˆœë²ˆ ë¶€ì—¬]
    E --> F[í˜„ì¬ ì‚¬ìš©ì ì™„ë£Œ ëŒ€ê¸°]
    F --> G[ì‹¤ì‹œê°„ ì•Œë¦¼ ë°œì†¡]
    G --> H{5ë¶„ ë‚´ ì‘ë‹µ?}
    
    H -->|ì˜ˆ| I[ì‚¬ìš© ì‹œì‘]
    H -->|ì•„ë‹ˆì˜¤| J[ìë™ ë§Œë£Œ]
    J --> K[ë‹¤ìŒ ìˆœë²ˆì—ê²Œ ì•Œë¦¼]
    
    C --> L[ì‚¬ìš© ì¤‘ ìƒíƒœ]
    I --> L
    L --> M[ì‚¬ìš© ì™„ë£Œ]
    M --> N[ë‹¤ìŒ ëŒ€ê¸°ìì—ê²Œ ì•Œë¦¼]
```

## ğŸ¯ API ì—”ë“œí¬ì¸íŠ¸

### ì¸ì¦ ê´€ë ¨
```http
GET    /api/auth/google              # Google OAuth ë¡œê·¸ì¸
GET    /api/auth/google/callback     # OAuth ì½œë°±
POST   /api/auth/logout              # ë¡œê·¸ì•„ì›ƒ
GET    /api/auth/me                  # í˜„ì¬ ì‚¬ìš©ì ì •ë³´
```

### ê¸°êµ¬ ê´€ë ¨
```http
GET    /api/equipment                # ê¸°êµ¬ ëª©ë¡ ì¡°íšŒ
GET    /api/equipment/categories     # ì¹´í…Œê³ ë¦¬ ëª©ë¡
GET    /api/equipment/:id            # ê¸°êµ¬ ìƒì„¸ ì •ë³´
```

### ì›¨ì´íŒ… ì‹œìŠ¤í…œ
```http
POST   /api/waiting/start-using/:equipmentId    # ê¸°êµ¬ ì‚¬ìš© ì‹œì‘
POST   /api/waiting/finish-using/:equipmentId   # ê¸°êµ¬ ì‚¬ìš© ì™„ë£Œ
POST   /api/waiting/queue/:equipmentId          # ëŒ€ê¸°ì—´ ë“±ë¡
DELETE /api/waiting/queue/:queueId              # ëŒ€ê¸°ì—´ ì·¨ì†Œ
GET    /api/waiting/status/:equipmentId         # ê¸°êµ¬ ìƒíƒœ ì¡°íšŒ
GET    /api/waiting/my-queues                   # ë‚´ ëŒ€ê¸°ì—´ í˜„í™©
```

### ì¦ê²¨ì°¾ê¸°
```http
GET    /api/favorites                # ì¦ê²¨ì°¾ê¸° ëª©ë¡
POST   /api/favorites                # ì¦ê²¨ì°¾ê¸° ì¶”ê°€  
DELETE /api/favorites/equipment/:id  # ì¦ê²¨ì°¾ê¸° ì œê±°
```

## ğŸ”” ì‹¤ì‹œê°„ ì•Œë¦¼ ì‹œìŠ¤í…œ

### WebSocket ì—°ê²°
```javascript
// í´ë¼ì´ì–¸íŠ¸ ì—°ê²°
const ws = new WebSocket('ws://localhost:4000/ws')

// ì¸ì¦
ws.send(JSON.stringify({
  type: 'auth', 
  token: 'your-jwt-token'
}))

// ì•Œë¦¼ ìˆ˜ì‹ 
ws.onmessage = (event) => {
  const data = JSON.parse(event.data)
  if (data.type === 'EQUIPMENT_AVAILABLE') {
    // ê¸°êµ¬ ì‚¬ìš© ê°€ëŠ¥ ì•Œë¦¼ ì²˜ë¦¬
    showNotification(data.message)
  }
}
```

### ì•Œë¦¼ íƒ€ì…
- **EQUIPMENT_AVAILABLE**: ê¸°êµ¬ ì‚¬ìš© ê°€ëŠ¥ (5ë¶„ ìœ ì˜ˆì‹œê°„ ì‹œì‘)
- **QUEUE_EXPIRED**: ì‹œê°„ ì´ˆê³¼ë¡œ ëŒ€ê¸°ì—´ì—ì„œ ì œê±°
- **auth_success**: WebSocket ì¸ì¦ ì„±ê³µ

## ğŸ‘¨â€ğŸ’¼ ê´€ë¦¬ì ê¸°ëŠ¥

### ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ
- ì „ì²´ ê¸°êµ¬ ì‚¬ìš© í˜„í™© ëª¨ë‹ˆí„°ë§
- ëŒ€ê¸°ì—´ ì‹¤ì‹œê°„ í˜„í™©
- ì‚¬ìš© í†µê³„ ë° ì¸ì‚¬ì´íŠ¸
- ê°•ì œ ì‚¬ìš© ì™„ë£Œ ê¸°ëŠ¥ (ê¸´ê¸‰ ìƒí™© ì‹œ)

### ì ‘ê·¼ ë°©ë²•
```
/admin ê²½ë¡œë¡œ ì ‘ì† (ê´€ë¦¬ì ê¶Œí•œ í•„ìš”)
```


### ì›¨ì´íŒ… ì‹œìŠ¤í…œ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸

1. **ê¸°ë³¸ í”Œë¡œìš° í…ŒìŠ¤íŠ¸**
   - ë‘ ê°œì˜ ë¸Œë¼ìš°ì € íƒ­ìœ¼ë¡œ ì„œë¡œ ë‹¤ë¥¸ ê³„ì • ë¡œê·¸ì¸
   - ì²« ë²ˆì§¸ ê³„ì •ì—ì„œ ê¸°êµ¬ ì‚¬ìš© ì‹œì‘
   - ë‘ ë²ˆì§¸ ê³„ì •ì—ì„œ ëŒ€ê¸°ì—´ ë“±ë¡
   - ì²« ë²ˆì§¸ ê³„ì •ì—ì„œ ì‚¬ìš© ì™„ë£Œ
   - ë‘ ë²ˆì§¸ ê³„ì •ì—ì„œ ì‹¤ì‹œê°„ ì•Œë¦¼ í™•ì¸

2. **íƒ€ì„ì•„ì›ƒ í…ŒìŠ¤íŠ¸**
   - ëŒ€ê¸°ì—´ ë“±ë¡ í›„ ì•Œë¦¼ ë°›ê¸°
   - 5ë¶„ ëŒ€ê¸° í›„ ìë™ ë§Œë£Œ í™•ì¸
   - ë‹¤ìŒ ìˆœë²ˆ ìë™ ì´ë™ í™•ì¸

## ğŸ“ˆ ì„±ëŠ¥ ìµœì í™”

### ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”
- ë³µí•© ì¸ë±ìŠ¤ ì„¤ì •: `(equipmentId, status)`
- ìœ ë‹ˆí¬ ì œì•½ì¡°ê±´: ì¤‘ë³µ ì‚¬ìš©/ëŒ€ê¸° ë°©ì§€
- ì¿¼ë¦¬ ìµœì í™”: í•„ìš”í•œ ë°ì´í„°ë§Œ ì¡°íšŒ

### WebSocket ìµœì í™”
- ì—°ê²° í’€ ê´€ë¦¬
- ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€
- ìë™ ì¬ì—°ê²° ë¡œì§

### ìºì‹± ì „ëµ
```javascript
// Redis ìºì‹± (ì„ íƒì‚¬í•­)
const redis = require('redis')
const client = redis.createClient()

// ê¸°êµ¬ ìƒíƒœ ìºì‹± (30ì´ˆ)
await client.setEx(`equipment:${id}:status`, 30, JSON.stringify(status))
```




## ğŸ”’ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### ì¸ì¦ ë° ì¸ê°€
- JWT í† í° ê¸°ë°˜ ì¸ì¦
- Google OAuth 2.0 ë³´ì•ˆ íë¦„
- ì„¸ì…˜ ê´€ë¦¬ ë° í† í° ê°±ì‹ 

### ë°ì´í„° ë³´í˜¸
```javascript
// ì…ë ¥ ë°ì´í„° ê²€ì¦
const { z } = require('zod')

const equipmentSchema = z.object({
  equipmentId: z.number().int().positive(),
  sets: z.number().int().min(1).max(20),
  restMinutes: z.number().int().min(1).max(10)
})
```

### WebSocket ë³´ì•ˆ
- í† í° ê¸°ë°˜ WebSocket ì¸ì¦
- CORS ì„¤ì •
- Rate Limiting

## ğŸ“Š ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…

### ë¡œê·¸ ì„¤ì •
```javascript
const winston = require('winston')

const logger = winston.createLogger({
  level: 'info',
  format: winston.format.json(),
  transports: [
    new winston.transports.File({ filename: 'error.log', level: 'error' }),
    new winston.transports.File({ filename: 'combined.log' })
  ]
})
```

### ì£¼ìš” ë©”íŠ¸ë¦­
- ë™ì‹œ ì‚¬ìš©ì ìˆ˜
- í‰ê·  ëŒ€ê¸° ì‹œê°„
- ê¸°êµ¬ë³„ ì‚¬ìš© ë¹ˆë„
- ì•Œë¦¼ ì „ë‹¬ ì„±ê³µë¥ 

## ğŸ¤ ê¸°ì—¬í•˜ê¸°



### ì½”ë“œ ìŠ¤íƒ€ì¼
- ESLint + Prettier ì„¤ì • ì¤€ìˆ˜
- ì»¤ë°‹ ë©”ì‹œì§€: [Conventional Commits](https://conventionalcommits.org/) í˜•ì‹

